# Repository Guidelines

## Project Structure & Module Organization

- `packages/`: Workspace packages.
- `packages/multicodex/`: TypeScript source for the `multicodex` CLI.
  - `src/`: Core modules, CLI entry (`src/cli.ts`), auth swapping (`src/auth-swap.ts`), config (`src/config.ts`).
  - `test/`: Unit tests (`bun:test`).
  - `docs/`: User documentation.
  - `dist/`: Build output (`dist/cli.js`, generated by `bun run build`).
  - `scripts/`: Small build/release helpers.

## Build, Test, and Development Commands

- `bun install`: install dependencies for all workspaces.
- `bun run dev`: run workspace `dev` scripts via Turborepo.
- `bun run test`: run unit tests across workspaces.
- `bun run typecheck`: run TypeScript typechecking across workspaces.
- `bun run build`: build all workspace packages.
- `npm pack --workspace packages/multicodex`: preview npm tarball for the CLI package.

## Coding Style & Naming Conventions

- Language: TypeScript (ESM).
- Prefer small, focused modules in `packages/multicodex/src/` with explicit exports.
- Naming:
  - files: `kebab-case.ts` for modules (e.g. `auth-swap.ts`)
  - functions: `camelCase`
  - types: `PascalCase`
- Keep CLI output and error messages actionable and user-facing.

## Testing Guidelines

- Framework: `bun:test`.
- Add tests for new behaviors and edge cases (flags, argument parsing, file I/O).
- Test files live under `packages/multicodex/test/` and use `*.test.ts` naming.

## Commit & Pull Request Guidelines

- Commit messages follow Conventional Commits (examples in history: `feat:`, `fix:`, `docs:`, `chore:`, `refactor:`).
- PRs should include:
  - a short description of the behavior change
  - updated docs if CLI UX changes (`packages/multicodex/README.md`, `packages/multicodex/docs/`)
  - tests for non-trivial logic changes

## Agent-Specific Instructions

- Do not create git commits (or rewrite history) unless explicitly asked.

## Security & Configuration Tips

- `multicodex` swaps `~/.codex/auth.json` under a lock; avoid manual edits while it is running.
- Local state is stored under `~/.config/multicodex` (override with `MULTICODEX_HOME` for testing).
